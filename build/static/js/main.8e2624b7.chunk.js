(this.webpackJsonpAmazon_Chime_Meeting=this.webpackJsonpAmazon_Chime_Meeting||[]).push([[0],{249:function(e,t){},250:function(e,t){},258:function(e,t){},262:function(e,t,a){"use strict";a.r(t);var i=a(17),n=a(111),o=a.n(n),r=a(84),c=a(148),s=a(232),d=a(5),l=a.n(d),u=l.a.mark(h);function h(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),u)}var f="none",g={counter:0,baseURL:"",roomID:"",userName:"",userAttendeeId:"",userBaseAttendeeId:"",region:"",joinInfo:null,meetingSessionConf:null,meetingSession:null,inputAudioDevices:null,inputVideoDevices:null,inputVideoResolutions:["360p","540p","720p"],outputAudioDevices:null,selectedInputAudioDevice:f,selectedInputVideoResolution:f,selectedInputVideoDevice:f,selectedOutputAudioDevice:f,storeRoster:{}},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0,a=Object.assign({},e);return a.counter++,console.log(e,t),a},p=a(264),V=Object(p.a)({INITIALIZE:function(e){return e}}),w=a(10),b=a(13),R=a(14),m=a(37),j=a(36),k=a(150),C=a(11),y=function(){var e=Object(C.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=navigator.mediaDevices.getUserMedia({audio:!1,video:{width:{ideal:1280},height:{ideal:720}}}),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=a(54),x=function(e){Object(m.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(b.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).localVideoRef=i.createRef(),e.localVideoCanvasRef=i.createRef(),e.localVideoMaskCanvasRef=i.createRef(),e.localVideoMaskCanvasRef2=i.createRef(),e.shareVideoRef=i.createRef(),e.shareVideoRef2=i.createRef(),e.localVideoMaskBackgroundRef=i.createRef(),e.localVideoMaskBGCanvasRef=i.createRef(),e.bodyPix=null,e.state={localVideoWidth:0,localVideoHeight:0,inputVideoStream:null,virtualBackground:"/resources/vbg/pic1.jpg"},e.drawVideoCanvas=function(){e.props;var t=e.bodyPix,a=(e.props,e.localVideoRef.current),i=e.localVideoCanvasRef.current,n=e.localVideoMaskCanvasRef.current,o=e.localVideoMaskCanvasRef2.current,r=e.localVideoMaskBackgroundRef.current,c=e.localVideoMaskBGCanvasRef.current;i.width=640,i.height=e.localVideoCanvasRef.current.width/16*9,i.getContext("2d").drawImage(a,0,0,i.width,i.height),t.segmentPerson(i).then((function(t){var a=k.c(t,{r:0,g:0,b:0,a:0},{r:255,g:255,b:255,a:255});k.a(n,i,a,1,2,!1);var s=n.getContext("2d").getImageData(0,0,n.width,n.height);r.src=e.state.virtualBackground,c.width=s.width,c.height=s.height;var d=c.getContext("2d");d.drawImage(r,0,0,c.width,c.height);for(var l=d.getImageData(0,0,c.width,c.height),u=new Uint8ClampedArray(s.width*s.height*4),h=0;h<s.height;h++)for(var f=0;f<s.width;f++){var g=4*(h*s.width+f);255===s.data[g]&&255===s.data[g+1]&&255===s.data[g+2]&&255===s.data[g+3]?(u[g]=l.data[g],u[g+1]=l.data[g+1],u[g+2]=l.data[g+2],u[g+3]=l.data[g+3]):(u[g]=s.data[g],u[g+1]=s.data[g+1],u[g+2]=s.data[g+2],u[g+3]=s.data[g+3])}var v=new ImageData(u,s.width,s.height);o.width=v.width,o.height=v.height,o.getContext("2d").putImageData(v,0,0)})),requestAnimationFrame((function(){return e.drawVideoCanvas()}))},e}return Object(R.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=(this.props,this.props,y().then((function(t){if(null!==t)return e.state.localVideoWidth=t.getVideoTracks()[0].getSettings().width?t.getVideoTracks()[0].getSettings().width:0,e.state.localVideoHeight=t.getVideoTracks()[0].getSettings().height?t.getVideoTracks()[0].getSettings().height:0,console.log("getVideoTrack",e.state.localVideoWidth,e.state.localVideoHeight),e.localVideoRef.current.srcObject=t,e.state.inputVideoStream=t,new Promise((function(t,a){e.localVideoRef.current.onloadedmetadata=function(){t()}}))}))),a=k.b();Promise.all([a,t]).then((function(t){var a=Object(w.a)(t,2),i=a[0];a[1];e.bodyPix=i,requestAnimationFrame((function(){return e.drawVideoCanvas()}))})).catch((function(e){console.error("not find... ",e)}))}},{key:"render",value:function(){return Object(O.jsxs)("div",{style:{width:"100%",margin:"auto"},children:[Object(O.jsx)("video",{ref:this.localVideoRef,style:{display:"None"},autoPlay:!0}),Object(O.jsx)("canvas",{ref:this.localVideoCanvasRef,style:{display:"None"},width:"100%",height:"100%"}),Object(O.jsx)("canvas",{ref:this.localVideoMaskCanvasRef,width:"100%",height:"100%",style:{display:"None"}}),Object(O.jsx)("canvas",{ref:this.localVideoMaskCanvasRef2,width:"100%",height:"100%",style:{display:"block"}}),Object(O.jsx)("img",{ref:this.localVideoMaskBackgroundRef,src:this.state.virtualBackground,style:{display:"None"}}),Object(O.jsx)("canvas",{ref:this.localVideoMaskBGCanvasRef,style:{display:"None"}})]})}}]),a}(i.Component);var I=Object(c.b)((function(e){return e}),(function(e){return{initialize:function(t){e(V.initialize(t))}}}))(x),M=Object(s.a)(),A=Object(r.d)(v,Object(r.a)(M));M.run(h),o.a.render(Object(O.jsx)(c.a,{store:A,children:Object(O.jsx)(I,{})}),document.getElementById("root"))}},[[262,1,2]]]);